import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import { axe, toHaveNoViolations } from 'jest-axe';
import { {{COMPONENT_NAME}} } from './{{COMPONENT_NAME}}';
import type { {{COMPONENT_NAME}}Props } from './{{COMPONENT_NAME}}.types';

// Extend Jest matchers
expect.extend(toHaveNoViolations);

/**
 * ðŸ§ª {{COMPONENT_NAME}} Tests - Generated by AI Scaffolder
 * Comprehensive test suite with accessibility checks
 */

// Mock data
const defaultProps: {{COMPONENT_NAME}}Props = {
  {{DEFAULT_TEST_PROPS}}
};

// Test utilities
const renderComponent = (props: Partial<{{COMPONENT_NAME}}Props> = {}) => {
  return render(<{{COMPONENT_NAME}} {...defaultProps} {...props} />);
};

describe('{{COMPONENT_NAME}}', () => {
  // Basic rendering tests
  describe('Rendering', () => {
    it('renders without crashing', () => {
      renderComponent();
      expect(screen.getByTestId('{{COMPONENT_NAME_LOWER}}')).toBeInTheDocument();
    });

    it('applies custom className', () => {
      const customClass = 'custom-test-class';
      renderComponent({ className: customClass });
      const element = screen.getByTestId('{{COMPONENT_NAME_LOWER}}');
      expect(element).toHaveClass(customClass);
    });

    it('renders children correctly', () => {
      const testContent = 'Test Content';
      renderComponent({ children: testContent });
      expect(screen.getByText(testContent)).toBeInTheDocument();
    });
  });

  // Variant tests
  describe('Variants', () => {
    it.each(['default', 'primary', 'secondary', 'destructive', 'outline'])(
      'renders %s variant correctly',
      (variant) => {
        renderComponent({ variant: variant as {{COMPONENT_NAME}}Props['variant'] });
        const element = screen.getByTestId('{{COMPONENT_NAME_LOWER}}');
        expect(element).toBeInTheDocument();
      }
    );
  });

  // State tests
  describe('States', () => {
    it('shows loading state', () => {
      renderComponent({ loading: true });
      expect(screen.getByRole('progressbar', { hidden: true })).toBeInTheDocument();
    });

    it('handles disabled state', () => {
      renderComponent({ disabled: true });
      const element = screen.getByTestId('{{COMPONENT_NAME_LOWER}}');
      expect(element).toHaveClass('opacity-50', 'pointer-events-none');
    });
  });

  // Interaction tests
  describe('Interactions', () => {
    it('handles click events', async () => {
      const handleClick = jest.fn();
      renderComponent({ onClick: handleClick });
      
      const element = screen.getByTestId('{{COMPONENT_NAME_LOWER}}');
      fireEvent.click(element);
      
      expect(handleClick).toHaveBeenCalledTimes(1);
    });

    it('handles keyboard navigation', async () => {
      renderComponent();
      const element = screen.getByTestId('{{COMPONENT_NAME_LOWER}}');
      
      fireEvent.keyDown(element, { key: 'Enter' });
      fireEvent.keyDown(element, { key: ' ' });
      fireEvent.keyDown(element, { key: 'Escape' });
      
      // Test should not crash
      expect(element).toBeInTheDocument();
    });
  });

  // Error handling tests
  describe('Error Handling', () => {
    it('displays error state correctly', () => {
      // Mock console.error to avoid test noise
      const consoleSpy = jest.spyOn(console, 'error').mockImplementation();
      
      renderComponent();
      
      // Simulate error condition here
      {{ERROR_TEST_SIMULATION}}
      
      consoleSpy.mockRestore();
    });
  });

  // Accessibility tests
  describe('Accessibility', () => {
    it('has no accessibility violations', async () => {
      const { container } = renderComponent();
      const results = await axe(container);
      expect(results).toHaveNoViolations();
    });

    it('supports keyboard navigation', () => {
      renderComponent();
      const element = screen.getByTestId('{{COMPONENT_NAME_LOWER}}');
      
      element.focus();
      expect(element).toHaveFocus();
    });

    it('has proper ARIA attributes', () => {
      renderComponent({ 'aria-label': 'Test Label' });
      const element = screen.getByTestId('{{COMPONENT_NAME_LOWER}}');
      expect(element).toHaveAttribute('aria-label', 'Test Label');
    });
  });

  // Performance tests
  describe('Performance', () => {
    it('does not re-render unnecessarily', () => {
      const renderSpy = jest.fn();
      
      function TestWrapper(props: {{COMPONENT_NAME}}Props) {
        renderSpy();
        return <{{COMPONENT_NAME}} {...props} />;
      }
      
      const { rerender } = render(<TestWrapper {...defaultProps} />);
      
      // Re-render with same props
      rerender(<TestWrapper {...defaultProps} />);
      
      // Should only render twice (initial + rerender)
      expect(renderSpy).toHaveBeenCalledTimes(2);
    });
  });

  {{CUSTOM_TESTS}}
});

// Snapshot test
describe('{{COMPONENT_NAME}} Snapshots', () => {
  it('matches snapshot', () => {
    const { container } = renderComponent();
    expect(container.firstChild).toMatchSnapshot();
  });
});
